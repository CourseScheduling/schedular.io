UTIL={a:{color:{},localStorage:{}}};UTIL.a.color={bgColor:function(a){return randomColor({v:"bright",format:"hex",B:parseInt(a,36)})}};UTIL.a.element={m:function(a,c){for(var b in c)a.style[b]=c[b]},create:function(a,c){var b=document.createElement(a);void 0!==c.h&&(b.innerHTML=c.h,delete c.h);for(var d in c)b.setAttribute(d,c[d]);return b}};
UTIL.a.time={u:function(a,c,b,d){return 0==a||0==b?!1:b>=a&&b<c||d>a&&d<c||a>=b&&a<d||c>b&&c<d?!0:!1},A:function(a,c){if(-1==a[0]||-1==c[0])return!1;for(var b=0;b<a.length;b++)if(-1<c.indexOf(a[b]))return!0;return!1}};UTIL.a.l={o:function(a,c,b){for(var d=0;d<a.length;d++)if(a[d][c]==b)return a[d];return!1},G:function(a){for(var c={},b=[],d=0,k=a.length;d<k;++d)c.hasOwnProperty(a[d])||(b.push(a[d]),c[a[d]]=1);return b}};
UTIL.a.localStorage=function(a){return{set:function(c,b,d){d=d||Date.now()+1E12;a.localStorage[c]=JSON.stringify(b);a.localStorage[c]+=Date.now()+d},get:function(c){var b=a.localStorage[c];if(!b)return 0;if(parseInt(b.substr(-13))<=Date.now())return!delete a.localStorage[c];try{return JSON.parse(b.slice(0,-13))}catch(d){return b.slice(0,-13)}}}}(window);function f(a){this.input=a.input;this.b=a.b;this.g=a.g;this.buttons=a.buttons;this.c={};this.f={};for(var c in a.c)this.c[c]=a.c[c].cloneNode(!0),this.c[c].id="";g(this);a=UTIL.a.localStorage.get("courses")||{};for(var b in a)h(this,b)(),this.f[b]=1;UTIL.a.localStorage.set("courses",a);return this}
function g(a){var c=a.input;c.addEventListener("keyup",function(){var b=c.value.trim();if(!b)return l(a);b=b.replace(/[^a-zA-Z\d\s:]/g,"");a.query(b,function(b){for(;a.b.children.length;)a.b.removeChild(a.b.children[0]);for(var c=0,m=b.length;c<m;c++){var e=a.c.result.cloneNode(!0);e.getElementsByClassName("result__header")[0].innerHTML=b[c].title;e.getElementsByClassName("result__body")[0].innerHTML=b[c].name;e.onclick=h(a,b[c].title);a.b.appendChild(e)}b=a.b;"block"!=b.style.display&&Velocity(b,
"slideDown",300)})});[].forEach.call(a.buttons,function(b){b.addEventListener("click",function(){document.location=b.getAttribute("href")+"?c="+Object.keys(a.f).join(",")})})}f.prototype.query=function(a,c){var b=UTIL.a.localStorage.get("token"),d="/api/v1/"+UTIL.a.localStorage.get("UNIVERSITY")+"/search?q="+a;$.get({D:b,url:d,done:c})};function l(a){a=a.b;"block"===a.style.display&&Velocity(a,"slideUp",300)}
function h(a,c){return function(){l(a);if(!a.f[c]){var b=UTIL.a.localStorage.get("courses");b[c]=1;a.f[c]=1;UTIL.a.localStorage.set("courses",b);b=a.c.i.cloneNode(!0);b.style.backgroundColor=UTIL.a.color.bgColor(c);b.getElementsByClassName("course__text")[0].innerHTML=c;a.g.appendChild(b);b.addEventListener("click",n(a,b,c));a.input.value=""}}}
function n(a,c,b){return function(){delete a.f[b];var d=UTIL.a.localStorage.get("courses");delete d[b];UTIL.a.localStorage.set("courses",d);c.parentNode.removeChild(c)}}window.j=new f({input:document.getElementById("courseInput"),b:document.getElementById("dropDown"),g:document.getElementById("courseContainer"),c:{result:document.getElementById("resultTemplate"),i:document.getElementById("courseTemplate")},buttons:document.getElementsByClassName("main__button")});
UTIL.a.localStorage.get("UNIVERSITY")||new Modal({type:"select",s:"<strong>Hey!</strong> What university do you go to?",options:{C:"SFU - Simon Fraser University",F:"UFV - University of the Fraser Valley"},w:function(a){UTIL.a.localStorage.set("UNIVERSITY",a,Date.now())}});
